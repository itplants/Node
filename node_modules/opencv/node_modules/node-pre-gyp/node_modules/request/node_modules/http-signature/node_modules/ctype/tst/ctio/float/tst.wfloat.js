/*
 * Another place to find bugs that may yet plague us. This time with writing out
 * floats to arrays. We are lazy and did basically just take the opposite of our
 * test code to read in values.
 */

var mod_ctype = require('../../../ctio.js');
var ASSERT = require('assert');


/*
 *	A useful thing to keep around for debugging
 *	console.log('buffer[0]: ' + buffer[0].toString(16));
 *	console.log('buffer[1]: ' + buffer[1].toString(16));
 *	console.log('buffer[2]: ' + buffer[2].toString(16));
 *	console.log('buffer[3]: ' + buffer[3].toString(16));
 *	console.log('buffer[4]: ' + buffer[4].toString(16));
 *	console.log('buffer[5]: ' + buffer[5].toString(16));
 * 	console.log('buffer[6]: ' + buffer[6].toString(16));
 *	console.log('buffer[7]: ' + buffer[7].toString(16));
 */

function testfloat()
{
	var buffer = new Buffer(4);
	mod_ctype.wfloat(0, 'big', buffer, 0);
	/* Start off with some of the easy ones: +zero */
	ASSERT.equal(0, buffer[0]);
	ASSERT.equal(0, buffer[1]);
	ASSERT.equal(0, buffer[2]);
	ASSERT.equal(0, buffer[3]);
	mod_ctype.wfloat(0, 'little', buffer, 0);
	ASSERT.equal(0, buffer[0]);
	ASSERT.equal(0, buffer[1]);
	ASSERT.equal(0, buffer[2]);
	ASSERT.equal(0, buffer[3]);

	/* Catch +infin */
	mod_ctype.wfloat(Number.POSITIVE_INFINITY, 'big', buffer, 0);
	ASSERT.equal(0x7f, buffer[0]);
	ASSERT.equal(0x80, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	mod_ctype.wfloat(Number.POSITIVE_INFINITY, 'little', buffer, 0);
	ASSERT.equal(0x7f, buffer[3]);
	ASSERT.equal(0x80, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	/* Catch -infin */
	mod_ctype.wfloat(Number.NEGATIVE_INFINITY, 'big', buffer, 0);
	ASSERT.equal(0xff, buffer[0]);
	ASSERT.equal(0x80, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	mod_ctype.wfloat(Number.NEGATIVE_INFINITY, 'little', buffer, 0);
	ASSERT.equal(0xff, buffer[3]);
	ASSERT.equal(0x80, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	/* Catch NaN */

	/*
	 * NaN Is a litle weird in its requirements, so we're going to encode a
	 * bit of how we actually implement it into this test. Probably not the
	 * best, since technically the sign is a don't care and the mantissa
	 * needs to just be non-zero.
	 */
	mod_ctype.wfloat(NaN, 'big', buffer, 0);
	ASSERT.equal(0x7f, buffer[0]);
	ASSERT.equal(0x80, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x17, buffer[3]);
	mod_ctype.wfloat(NaN, 'little', buffer, 0);
	ASSERT.equal(0x7f, buffer[3]);
	ASSERT.equal(0x80, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x17, buffer[0]);

	/* On to some basic tests */
	/* 1.125 */
	mod_ctype.wfloat(1.125, 'big', buffer, 0);
	ASSERT.equal(0x3f, buffer[0]);
	ASSERT.equal(0x90, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	mod_ctype.wfloat(1.125, 'little', buffer, 0);
	ASSERT.equal(0x3f, buffer[3]);
	ASSERT.equal(0x90, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	mod_ctype.wfloat(1.0000001192092896, 'big', buffer, 0);
	ASSERT.equal(0x3f, buffer[0]);
	ASSERT.equal(0x80, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x01, buffer[3]);
	mod_ctype.wfloat(1.0000001192092896, 'little', buffer, 0);
	ASSERT.equal(0x3f, buffer[3]);
	ASSERT.equal(0x80, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x01, buffer[0]);

	mod_ctype.wfloat(1.0000001192092896, 'big', buffer, 0);
	ASSERT.equal(0x3f, buffer[0]);
	ASSERT.equal(0x80, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x01, buffer[3]);
	mod_ctype.wfloat(1.0000001192092896, 'little', buffer, 0);
	ASSERT.equal(0x3f, buffer[3]);
	ASSERT.equal(0x80, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x01, buffer[0]);

	mod_ctype.wfloat(2.3283067140944524e-10, 'big', buffer, 0);
	ASSERT.equal(0x2f, buffer[0]);
	ASSERT.equal(0x80, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x01, buffer[3]);
	mod_ctype.wfloat(2.3283067140944524e-10, 'little', buffer, 0);
	ASSERT.equal(0x2f, buffer[3]);
	ASSERT.equal(0x80, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x01, buffer[0]);

	/* ff34a2b0 -2.4010576103645774e+38 */
	mod_ctype.wfloat(-2.4010576103645774e+38,
	    'big', buffer, 0);
	ASSERT.equal(0xff, buffer[0]);
	ASSERT.equal(0x34, buffer[1]);
	ASSERT.equal(0xa2, buffer[2]);
	ASSERT.equal(0xb0, buffer[3]);
	mod_ctype.wfloat(-2.4010576103645774e+38,
	    'little', buffer, 0);
	ASSERT.equal(0xff, buffer[3]);
	ASSERT.equal(0x34, buffer[2]);
	ASSERT.equal(0xa2, buffer[1]);
	ASSERT.equal(0xb0, buffer[0]);

	/* Denormalized tests */

	/* 0003f89a +/- 3.6468792534053364e-40 */
	mod_ctype.wfloat(3.6468792534053364e-40,
	    'big', buffer, 0);
	ASSERT.equal(0x00, buffer[0]);
	ASSERT.equal(0x03, buffer[1]);
	ASSERT.equal(0xf8, buffer[2]);
	ASSERT.equal(0x9a, buffer[3]);
	mod_ctype.wfloat(3.6468792534053364e-40,
	    'little', buffer, 0);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x03, buffer[2]);
	ASSERT.equal(0xf8, buffer[1]);
	ASSERT.equal(0x9a, buffer[0]);

	mod_ctype.wfloat(-3.6468792534053364e-40,
	    'big', buffer, 0);
	ASSERT.equal(0x80, buffer[0]);
	ASSERT.equal(0x03, buffer[1]);
	ASSERT.equal(0xf8, buffer[2]);
	ASSERT.equal(0x9a, buffer[3]);
	mod_ctype.wfloat(-3.6468792534053364e-40,
	    'little', buffer, 0);
	ASSERT.equal(0x80, buffer[3]);
	ASSERT.equal(0x03, buffer[2]);
	ASSERT.equal(0xf8, buffer[1]);
	ASSERT.equal(0x9a, buffer[0]);

	/* Maximum and minimum normalized and denormalized values */

	/* Largest normalized number +/- 3.4028234663852886e+38 */

	mod_ctype.wfloat(3.4028234663852886e+38,
	    'big', buffer, 0);
	ASSERT.equal(0x7f, buffer[0]);
	ASSERT.equal(0x7f, buffer[1]);
	ASSERT.equal(0xff, buffer[2]);
	ASSERT.equal(0xff, buffer[3]);
	mod_ctype.wfloat(3.4028234663852886e+38,
	    'little', buffer, 0);
	ASSERT.equal(0x7f, buffer[3]);
	ASSERT.equal(0x7f, buffer[2]);
	ASSERT.equal(0xff, buffer[1]);
	ASSERT.equal(0xff, buffer[0]);

	mod_ctype.wfloat(-3.4028234663852886e+38,
	    'big', buffer, 0);
	ASSERT.equal(0xff, buffer[0]);
	ASSERT.equal(0x7f, buffer[1]);
	ASSERT.equal(0xff, buffer[2]);
	ASSERT.equal(0xff, buffer[3]);
	mod_ctype.wfloat(-3.4028234663852886e+38,
	    'little', buffer, 0);
	ASSERT.equal(0xff, buffer[3]);
	ASSERT.equal(0x7f, buffer[2]);
	ASSERT.equal(0xff, buffer[1]);
	ASSERT.equal(0xff, buffer[0]);

	/* Smallest normalied number +/- 1.1754943508222875e-38 */

	mod_ctype.wfloat(1.1754943508222875e-38,
	    'big', buffer, 0);
	ASSERT.equal(0x00, buffer[0]);
	ASSERT.equal(0x80, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	mod_ctype.wfloat(1.1754943508222875e-38,
	    'little', buffer, 0);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x80, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	mod_ctype.wfloat(-1.1754943508222875e-38,
	    'big', buffer, 0);
	ASSERT.equal(0x80, buffer[0]);
	ASSERT.equal(0x80, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	mod_ctype.wfloat(-1.1754943508222875e-38,
	    'little', buffer, 0);
	ASSERT.equal(0x80, buffer[3]);
	ASSERT.equal(0x80, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	/* Smallest denormalized number 1.401298464324817e-45 */
	mod_ctype.wfloat(1.401298464324817e-45,
	    'big', buffer, 0);
	ASSERT.equal(0x00, buffer[0]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x01, buffer[3]);
	mod_ctype.wfloat(1.401298464324817e-45,
	    'little', buffer, 0);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x01, buffer[0]);

	mod_ctype.wfloat(-1.401298464324817e-45,
	    'big', buffer, 0);
	ASSERT.equal(0x80, buffer[0]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x01, buffer[3]);
	mod_ctype.wfloat(-1.401298464324817e-45,
	    'little', buffer, 0);
	ASSERT.equal(0x80, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x01, buffer[0]);

	/* Largest denormalized value +/- 1.1754942106924411e-38 */

	mod_ctype.wfloat(1.1754942106924411e-38,
	    'big', buffer, 0);
	ASSERT.equal(0x00, buÓfeV[ U´+
	¡C[ERîéeq}Elh∞x<f,`&ıff‰2_y]-≥
pSSTtÂpUalh0Xff, kudfgÛ[≤);)CUSEsT,es}·f(0xdf,"ps4fÂxW7
;	mdXÁtyp!Æ[vLoEd(3n17%9435∞∂π6$tqyF/3<ãâ†‚" 'lmdv&%'l$(ıffg2,!0;A¡[eVT.Âq‰·d 3x50l r5'eE‚S≥_-;
AQSR‹&mqu{È)±{3`¨®bygÁeRZ6M0	ÒSsUB\m9ï‡(,"|ff- bfntÚ[1I){
IAS”bRF*es˜gj,0vd. budfer⁄1≈)3JJmo SCtY0eowfÏe5(-±,s7•4;6Q61™<=a1}-38(
)	`` &bic'6 bunn|b- ¥	?z)·_”EZV.uquaÏ"8x<1, j1df/r[0]-+ä@[mzTE3uÒl(pt7Ê$‚bu$¶urC1M)ø
aQ“ER@.kqui,(4xˆf* buFfe“["]!3QQ[eVT.${9al(R8f`, bugferYsX;Xˇol_ctqpa.wf(oaT(=π>uì96π|41=06001e=#:4+	0∞( 7mi0jlE+("‚ufjÙr, 0);¢I√2SEZT.eQt±dkr4(p,†bınder[1X-;*â@SqLRƒÂ}}A|0|ßÓ=
btffMr{2yi;òASSÖT.aqwem  xÊfm`"uDdeÛS1)@SEFdn-!U·,(0HFb`"uˆvÁr0]);
	*!To0rolc:u˜aakpgFqm¥ Ùdpull‰0'à	 ubfgz(=&jE7`Buf‡ebx^)9#	mme?ctppulwdlÔAt†- ≤<≤3640£&05uweMc6Ó	(  a/Vißw byvfÂq, 2-
ç…SCURTdqı·mh0<q¨"b}&feˆZ:Y)9:	QSGUrZ'u5aN pz'9, BuÍ&%s3|){
iSSWtÆEqp!L(49Kd,$effuv[¶T)k	¡”WQH.˜uuA‹(,xì&& bu&fgr8U]);
j	ÌodGgmyeØwflo`4(-,47;0§T07>∞v5øg;≥2h
 ` 0#uHEwte"ÚÒtfgr,$3)ö
	ASSERT.equal(0x8a, buffer[5]);
	ASSERT.equal(0x79, buffer[4]);
	ASSERT.equal(0xcd, buffer[3]);
	ASSERT.equal(0x3f, buffer[2]);

}

function testdouble()
{
	var buffer = new Buffer(10);

	/* Check 0 */
	mod_ctype.wdouble(0, 'big', buffer, 0);
	ASSERT.equal(0x00, buffer[0]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[7]);
	mod_ctype.wdouble(0, 'little', buffer, 0);
	ASSERT.equal(0x00, buffer[7]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	/* Check NaN */
	/* Similar to floats we are only generating a subset of values */
	mod_ctype.wdouble(NaN, 'big', buffer, 0);
	ASSERT.equal(0x7f, buffer[0]);
	ASSERT.equal(0xf0, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x17, buffer[7]);
	mod_ctype.wdouble(NaN, 'little', buffer, 0);
	ASSERT.equal(0x7f, buffer[7]);
	ASSERT.equal(0xf0, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x17, buffer[0]);

	/* pos inf */
	mod_ctype.wdouble(Number.POSITIVE_INFINITY,
	    'big', buffer, 0);
	ASSERT.equal(0x7f, buffer[0]);
	ASSERT.equal(0xf0, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[7]);
	mod_ctype.wdouble(Number.POSITIVE_INFINITY,
	    'little', buffer, 0);
	ASSERT.equal(0x7f, buffer[7]);
	ASSERT.equal(0xf0, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	/* neg inf */
	mod_ctype.wdouble(Number.NEGATIVE_INFINITY,
	    'big', buffer, 0);
	ASSERT.equal(0xff, buffer[0]);
	ASSERT.equal(0xf0, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[7]);
	mod_ctype.wdouble(Number.NEGATIVE_INFINITY,
	    'little', buffer, 0);
	ASSERT.equal(0xff, buffer[7]);
	ASSERT.equal(0xf0, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	/* Simple normalized values */

	/* +/- 1.125 */
	mod_ctype.wdouble(1.125,
	    'big', buffer, 0);
	ASSERT.equal(0x3f, buffer[0]);
	ASSERT.equal(0xf2, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[7]);

	mod_ctype.wdouble(1.125,
	    'little', buffer, 0);
	ASSERT.equal(0x3f, buffer[7]);
	ASSERT.equal(0xf2, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	mod_ctype.wdouble(-1.125,
	    'big', buffer, 0);
	ASSERT.equal(0xbf, buffer[0]);
	ASSERT.equal(0xf2, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[7]);

	mod_ctype.wdouble(-1.125,
	    'little', buffer, 0);
	ASSERT.equal(0xbf, buffer[7]);
	ASSERT.equal(0xf2, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);


	/* +/- 1.4397318913736026e+283 */
	mod_ctype.wdouble(1.4397318913736026e+283,
	    'big', buffer, 0);
	ASSERT.equal(0x7a, buffer[0]);
	ASSERT.equal(0xb8, buffer[1]);
	ASSERT.equal(0xc9, buffer[2]);
	ASSERT.equal(0x34, buffer[3]);
	ASSERT.equal(0x72, buffer[4]);
	ASSERT.equal(0x16, buffer[5]);
	ASSERT.equal(0xf9, buffer[6]);
	ASSERT.equal(0x0e, buffer[7]);

	mod_ctype.wdouble(1.4397318913736026e+283,
	    'little', buffer, 0);
	ASSERT.equal(0x7a, buffer[7]);
	ASSERT.equal(0xb8, buffer[6]);
	ASSERT.equal(0xc9, buffer[5]);
	ASSERT.equal(0x34, buffer[4]);
	ASSERT.equal(0x72, buffer[3]);
	ASSERT.equal(0x16, buffer[2]);
	ASSERT.equal(0xf9, buffer[1]);
	ASSERT.equal(0x0e, buffer[0]);

	mod_ctype.wdouble(-1.4397318913736026e+283,
	    'big', buffer, 0);
	ASSERT.equal(0xfa, buffer[0]);
	ASSERT.equal(0xb8, buffer[1]);
	ASSERT.equal(0xc9, buffer[2]);
	ASSERT.equal(0x34, buffer[3]);
	ASSERT.equal(0x72, buffer[4]);
	ASSERT.equal(0x16, buffer[5]);
	ASSERT.equal(0xf9, buffer[6]);
	ASSERT.equal(0x0e, buffer[ΩY*;
Ïol„uyzeéﬂdluclmÆ-q.439µ#1∞919?#∂026-+:3,ä '(&'lh4tle'<!bıffh{$:0+;
EAeR\Üequml !z&,"Êufler[3]),I¡ssQR‘eAtCl(0`b9 ruÂf˘ÚÀ6,;K	@SQU“UÓÁ#wmi(0pc=-`buÊg%r[,U)+	Q”RTke≈‡Ì 0x34<bsneS¬5ú¨;
I!SSURTØf1al®0Ìs2(§˙ufvÂv[3])2HπQIRT.EquÒ¨80p16, $q&bBr€"]);
ASY«*V.atu¡l*40Êx$0byfflrZ±}ã;
AsWEVuS-°] Ëxa( Bıgg%Ú1\™)Ø* D%ntx/)liNEd6e|qes *o9/*`*Ø- z/¯2µ6P˛2r22:∞44%≠31: *.)mnd_ce˘qd.wdnuD,e(º8r52±6623>∫3$De/0≤8	§"` /jig', jt∆f!r>d );é	I[WgAV.$Yu{dj≤x0t, F5fder[%M#;QSerTˇeqead(0y0d, `wFvuÚu%—!;™	E[SU.`pve$(:x=0d¨buvbmZ[:Y)y
…SS≈R^.eyt·|)0x9<, `Tt2tr[2Ml)ö	ÖQSRTlDwuaŒ(1xx≠ ˜dBq[$›®9IERMR\.qqQÒlI0X≤&,!bpdlEr[4‹	{JCSSÜV.¡qe#d(00a,)BeFÊm2R Y)HI”rER&Apqqe)0qCd,"mfbuv€w])9
	l~‘_Îtape(∑dou‚le<8,~:4:%2kr63§6e=129%	 `$(#hittLf-§1fıfFeÛ,†0)3aí[EPD.%qwco®|8p< jtnÊDr_WYi2ä)A[3ERDÆÌaedla5h Æ¥ fU‚f_	{KÖUWQECUuA|al(2j58m#buffer@=]π?
	iSRERL+Equbl8êxy4,-bu7u}b[4M)3	i”bEb|.ÁÒwq,(≤!3,•(}ÚE[3_-{
ARRdr.ªucn8 x25Ã J5nDdvR:]);	SÒBW:ıqp‚|(0¯a `unfarX!-=B	a–”URT>stcÍ(0xcd, buffer[0]);

	mod_ctype.wdouble(-8.82521232268344e-309,
	    'big', buffer, 0);
	ASSERT.equal(0x80, buffer[0]);
	ASSERT.equal(0x06, buffer[1]);
	ASSERT.equal(0x58, buffer[2]);
	ASSERT.equal(0x94, buffer[3]);
	ASSERT.equal(0x13, buffer[4]);
	ASSERT.equal(0x27, buffer[5]);
	ASSERT.equal(0x8a, buffer[6]);
	ASSERT.equal(0xcd, buffer[7]);

	mod_ctype.wdouble(-8.82521232268344e-309,
	    'little', buffer, 0);
	ASSERT.equal(0x80, buffer[7]);
	ASSERT.equal(0x06, buffer[6]);
	ASSERT.equal(0x58, buffer[5]);
	ASSERT.equal(0x94, buffer[4]);
	ASSERT.equal(0x13, buffer[3]);
	ASSERT.equal(0x27, buffer[2]);
	ASSERT.equal(0x8a, buffer[1]);
	ASSERT.equal(0xcd, buffer[0]);


	/* Edge cases, maximum and minimum values */

	/* Smallest denormalized value 5e-324 */
	mod_ctype.wdouble(5e-324,
	    'big', buffer, 0);
	ASSERT.equal(0x00, buffer[0]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x01, buffer[7]);

	mod_ctype.wdouble(5e-324,
	    'little', buffer, 0);
	ASSERT.equal(0x00, buffer[7]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x01, buffer[0]);

	mod_ctype.wdouble(-5e-324,
	    'big', buffer, 0);
	ASSERT.equal(0x80, buffer[0]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x01, buffer[7]);

	mod_ctype.wdouble(-5e-324,
	    'little', buffer, 0);
	ASSERT.equal(0x80, buffer[7]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x01, buffer[0]);



	/* Largest denormalized value 2.225073858507Ú01e-p∏i*/Ç	moDü‰uytElˇ‰ouble,í&"Ú%rø1|µ0t0?s0=g,∂<-
	*   &`k67, „ufVer 1=#
@sWUZ–6aQt©n)l800<§`U~faRY0}!<
ÅACe“\>dqta* xq$cUfÙ·Ú[]);
	QWSÕ“’Ô•wuaLhnn<£cı+ferk2]+9	A¡QRTjÖq‰Â j0pfw, b}sgm‚[∫]);
T[SER◊&uqudË0∞hff¨ftF£vrS4]!7J¡SK]P\neqÒ®j,"x&f$BwFFdÚIu]
	@Y√MrT/ey˜mj< ¯ÊÊ$ juffer€˝k3ARERT/aAuah,¥xGc, ¬ufbÁZKvU)ª

çmk`>sty2E,wdoqb,e(2.225?;9502≤%15˝≥08m* p †'lyuum7/" b}fvar<(-{
][sER.ıawc|,∞P00),¢unfer[∑9çBSqMR].m1ual®0q0v$ jwÊfmz_6M(3E?CURV*e1eczit8&f,!ju&.uR|)ø.	ASPAS.esq!l-68‰v.°BuÓj-R[>]9;*@GREH+eqÙam00xffl BufÁer[≤}>	a«WERPo}QAl,0|Ff,hf5Êb≈R[]9;
AS”ERX*%·}Â,0pd&†Í5ffer_4Y-;IÛ[EStéDqqal> |ff†b}vtcr]0œ:
IocD_`tx`g.'dÔ}r,e()2,28ï07q8u5001e,319,*	)| ‡'`iv?-·bTÊf≈t% )∫Je€G%RD.w}uaf(xx0x-%‚W&Fmr0Y);ASSASTe=’ad†4xpÊ-¢bsffp€0]){
	`SWG“T.-qwaH(2ºff> b5v∆urY9);®ãASWMR(eŸıelhêxo‰/dF4FfÂV[3)3
ACQERP.e9WadhPxvl,2fÒgfEr[6›iªJ	!SRP¿<eqUa,8 xFf. CqF6ez 4M);
È¡WSDTße1q·l(4˘&f  btffu2W6]);
	¡SWGVH.%uıal(9p&f,$ unfe{R∑] äa˚t[sÙqhc.BLo5s|t)-r.186∞¥S:7z5r72≤1e-308,
	    'little', buffer, 0);
	ASSERT.equal(0x80, buffer[7]);
	ASSERT.equal(0x0f, buffer[6]);
	ASSERT.equal(0xff, buffer[5]);
	ASSERT.equal(0xff, buffer[4]);
	ASSERT.equal(0xff, buffer[3]);
	ASSERT.equal(0xff, buffer[2]);
	ASSERT.equal(0xff, buffer[1]);
	ASSERT.equal(0xff, buffer[0]);


	/* Smallest normalized value 2.2250738585072014e-308 */
	mod_ctype.wdouble(2.2250738585072014e-308,
	    'big', buffer, 0);
	ASSERT.equal(0x00, buffer[0]);
	ASSERT.equal(0x10, buffer[1]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[6]);
	ASSERT.equal(0x00, buffer[7]);

	mod_ctype.wdouble(2.2250738585072014e-308,
	    'little', buffer, 0);
	ASSERT.equal(0x00, buffer[7]);
	ASSERT.equal(0x10, buffer[6]);
	ASSERT.equal(0x00, buffer[5]);
	ASSERT.equal(0x00, buffer[4]);
	ASSERT.equal(0x00, buffer[3]);
	ASSERT.equal(0x00, buffer[2]);
	ASSERT.equal(0x00, buffer[1]);
	ASSERT.equal(0x00, buffer[0]);

	mod_ctype.wdouble(-2Æ2!03∏}85¢708qø‰-28yl
å$@" 'r˘g&¶!b}dfır,"Y3;
K@ﬂQU\noQual((xy44°btboaZ[1]`>	AWE“&equcm(0z02¨ C}fvwp_5]);Ç	AsƒRTnAteAn0x$0# ÙÊÂrWx+;
YAQ€E”÷'fqYAl  x80/!‚?ffeb5_!9	¡CGRPÜeÒı!d+q|1%, jqfkÂs˚4]){	IS”E“V>`q}·l® x0¥!b’ßv5r[5U):
âAJZERP.e±§h,+400@, buvÊr[\	?
A√CbBT.uı}a ∞hq0.hbdffu˙Kß]1nJ,Ot_cvYqe.7‰nUcleàm2(¢3#p6s¯58Ö0w0094e/ (,H"   #Ï#ttLo'- bxÊfgs-®©;
_a]QeR‘/equqm*000> jegfeÛ_6])?
9SCE“Dbgqu·D*0i9∞, buf`Â|;]©;
!	S[AXTndqıam(0q 8.‡fcnF!bY4)?+	YSSUgqudl(4i10, buF&gpı=);
 ACSdFT(e9=g<¨0z±,©j}FfmVy3x%:
A[EBTÆeqtal(0x <"„utj‰z[2i3äAS1AZT.Ep|qti Pi∞†b•"be2[0[-1
âA{iVƒ.Âuea|,0p∞∏< buFfmrY0Ÿi{ò*
	/™
LAbc5su joÚeIli{Ed ˜aluEe"v976#q?8Ê;30!7a+q(∞j/	mkd}suY4e.5d?UjlG8uÆ797t='53tö6¢15'e®3&u¨*	0  fjigo,dBugF‰s$09)3	ASEJT
aqtyd(y7∆, `ÂlÊurS0U)õ
	ASS%PTng˘]al(0xmf*§bwnfms[±]-;
	Qs”≈BD,m@u`®}ff†4{Ùffd2S3ﬂ#;
	ASREBF-mQ5#d( zfF,62=ffd“;3]){
	AsSET&qıel(pxfu0j}f&eb[6T)´B	SIÁ“^Lu”L“f$ê"7dfe{'u(_	WsEÊT.guma,±xff-0"uff%t[]+2Ä@`W{•rTæEqsÒ‰h:Mff,0buFGeÚ[)∫™-okd~cpÿpe.wdouble(1.7976931348623157e+308,
	    'little', buffer, 0);
	ASSERT.equal(0x7f, buffer[7]);
	ASSERT.equal(0xef, buffer[6]);
	ASSERT.equal(0xff, buffer[5]);
	ASSERT.equal(0xff, buffer[4]);
	ASSERT.equal(0xff, buffer[3]);
	ASSERT.equal(0xff, buffer[2]);
	ASSERT.equal(0xff, buffer[1]);
	ASSERT.equal(0xff, buffer[0]);

	mod_ctype.wdouble(-1.7976931348623157e+308,
	    'big', buffer, 0);
	ASSERT.equal(0xff, buffer[0]);
	ASSERT.equal(0xef, buffer[1]);
	ASSERT.equal(0xff, buffer[2]);
	ASSERT.equal(0xff, buffer[3]);
	ASSERT.equal(0xff, buffer[4]);
	ASSERT.equal(0xff, buffer[5]);
	ASSERT.equal(0xff, buffer[6]);
	ASSERT.equal(0xff, buffer[7]);

	mod_ctype.wdouble(-1.7976931348623157e+308,
	    'little', buffer, 0);
	ASSERT.equal(0xff, buffer[7]);
	ASSERT.equal(0xef, buffer[6]);
	ASSERT.equal(0xff, buffer[5]);
	ASSERT.equal(0xff, buffer[4]);
	ASSERT.equal(0xff, buffer[3]);
	ASSERT.equal(0xff, buffer[2]);
	ASSERT.equal(0xff, buffer[1]);
	ASSERT.equal(0xff, buffer[0]);


	/* Try offsets */
	buffer[0] = 0xde;
	buffer[1] = 0xad;
	buffer[2] = 0xbe;
	buffer[3] = 0xef;
	buffer[4] = 0xba;
	buffer[5] = 0xdd;
	buffer[6] = 0xca;
	buffer[7] = 0xfe;
	buffer[8] = 0x16;
	buffer[9] = 0x79;

	mod_ctype.wdouble(-0.000015130017658081283,
	    'big', buffer, 2);
	ASSERT.equal(0xbe, buffer[2]);
	ASSERT.equal(0xef, buffer[3]);
	ASSERT.equal(0xba, buffer[4]);
	ASSERT.equal(0xdd, buffer[5]);
	ASSERT.equal(0xca, buffer[6]);
	ASSERT.equal(0xfe, buffer[7]);
	ASSERT.equal(0x16, buffer[8]);
	ASSERT.equal(0x79, buffer[9]);

	mod_ctype.wdouble(-0.000015130017658081283,
	    'little', buffer, 2);
	ASSERT.equal(0xbe, buffer[9]);
	ASSERT.equal(0xef, buffer[8]);
	ASSERT.equal(0xba, buffer[7]);
	ASSERT.equal(0xdd, buffer[6]);
	ASSERT.equal(0xca, buffer[5]);
	ASSERT.equal(0xfe, buffer[4]);
	ASSERT.equal(0x16, buffer[3]);
	ASSERT.equal(0x79, buffer[2]);
}

testfloat();
testdouble();
